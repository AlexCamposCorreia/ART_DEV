    Sub CreateNewModelFiles()

        LogThis("Writing new dates on Model.dat input data file for todays forecast...")

        For Each Model As Model In Models

            'change initial and final dates
            Dim NewModelInputFile As New OutData(Model.Path + "data\Model_" + Model.RunID.ToString + ".dat")
            NewModelInputFile.WriteDataLine("START", InitialDate)
            NewModelInputFile.WriteDataLine("END", FinalDate)
            NewModelInputFile.WriteDataLine("DT", Model.TimeStep)
            NewModelInputFile.WriteDataLine("VARIABLEDT", Model.HasVariableDT)
            If Model.HasVariableDT Then
                NewModelInputFile.WriteDataLine("MAXDT", Model.MaxDT)
            End If
            NewModelInputFile.WriteDataLine("GMTREFERENCE", 0)
            NewModelInputFile.WriteDataLine("OPENMP_NUM_THREADS", OpenMP_Num_Threads)
            If Model.HasLagrangian Then
                NewModelInputFile.WriteDataLine("LAGRANGIAN", 1)
            End If
            If Model.HasWaves Then
            End If
            NewModelInputFile.Finish()

        Next


    End Sub
